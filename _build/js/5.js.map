{"version":3,"sources":["webpack:///./_src/modules/gallery/gallery.ts","webpack:///./_src/js/core/module.ts","webpack:///./_src/modules/gallery/gallery-item.html"],"names":["__webpack_require__","Gallery","el","opts","_classCallCheck","this","_this","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","call","filters","loadCnt","scrollThreshold","_module2","default","dom","imgs","magnificPopup","delegate","type","removalDelay","mainClass","gallery","enabled","preload","navigateByImgClick","arrowMarkup","tPrev","tNext","tCounter","zoom","duration","easing","opener","openerElement","is","find","callbacks","change","isOpen","wrap","addClass","fixedContentPos","finalTilesGallery","margin","minTileWidth","gridSize","imageSizeFactor","columns","_this2","loadmoreLnk","on","e","onLoadMoreClick","self","$","currentTarget","filter","toggleClass","scrollTop","data","includes","splice","findIndex","item","push","onGetGalleryImages","preventDefault","getJSON","getGalleryImages","images","_iterator","Symbol","iterator","_iteratorNormalCompletion","_step","next","done","image","value","append","_template2","_galleryItem2","updateDom","setTimeout","_this3","imgLnk","removeClass","renderGallery","then","Promise","resolve","catch","err","reject","Error","_utils","Module","element","arguments","length","undefined","options","getInstanceOfjQuery","ReferenceError","assign","preInit","init","bindEventListeners","render","_bootstrap","getCachableDomElements","module","exports"],"mappings":"iaAQAA,EAAA,UAGAA,EAAA,6DAEAC,cAOI,SAAAA,EAAYC,EAAqBC,gGAAYC,CAAAC,KAAAJ,GAAA,IAAAK,mKAAAC,CAAAF,MAAAJ,EAAAO,WAAAC,OAAAC,eAAAT,IAAAU,KAAAN,KAEnCH,EAAIC,IAF+B,OALrCG,EAAAM,WACAN,EAAAO,QAAkB,EAETP,EAAAQ,gBAA0B,IAEER,qUAP3BS,EAAAC,6CAcpBX,KAAKY,IAAIC,KAAKC,eAEJC,SAAU,qCACVC,KAAM,QACNC,aAAc,IACdC,UAAW,yBACXC,SAEIC,SAAS,EACTC,SAAU,EAAE,GACZC,oBAAoB,EACpBC,YAAa,oFACbC,MAAO,4BACPC,MAAO,yBACPC,SAAU,sDAEdC,MAEIP,SAAS,EACTQ,SAAU,IACVC,OAAQ,cACRC,OAAQ,SAASC,GAEb,OAAOA,EAAcC,GAAG,OAASD,EAAgBA,EAAcE,KAAK,SAG5EC,WAEIC,OAAQ,WAEAnC,KAAKoC,QAELpC,KAAKqC,KAAKC,SAAS,cAIlCC,iBAAiB,IAGlBvC,KAAKY,IAAIC,KAAK2B,mBAEVC,OAAQ,GACRC,aAAc,IACdC,SAAU,GACVC,kBAAmB,IAAM,KAAK,KAAM,KAAK,KAAM,KAAK,IAAK,KAAK,IAAK,KACnEC,UAEK,IAAM,IACN,KAAM,IACN,KAAM,IACN,IAAK,IACL,IAAK,mDAKA,IAAAC,EAAA9C,KAKdA,KAAKY,IAAImC,YAAYC,GAAG,iBAAkB,SAACC,GAAD,OAAOH,EAAKI,gBAAgBD,4CAG3DA,GAEX,IAAME,EAAOC,EAAEH,EAAEI,eAEjBrD,KAAKY,IAAI0C,OAAOC,YAAY,SAAUJ,EAAKK,YAAcxD,KAAKS,wDAGnDwC,GAEX,IAAME,EAAOC,EAAEH,EAAEI,eACXC,EAASH,EAAKM,KAAK,UAErBzD,KAAKO,QAAQmD,SAASJ,GAEtBtD,KAAKO,QAAQoD,OAAO3D,KAAKO,QAAQqD,UAAU,SAACC,GAExC,OAAOA,IAASP,IAChB,GAIJtD,KAAKO,QAAQuD,KAAKR,GAGtBH,EAAKI,YAAY,iCAIjBvD,KAAK+D,qBAELd,EAAEe,yDAGUf,GAEZjD,KAAK+D,qBAELd,EAAEe,4DAKF,OAAOZ,EAAEa,QAAQ,2fAKIjE,KAAKkE,0BAM1B,IANMC,wCAMNC,EAAkBD,EAAlBE,OAAAC,cAAAC,GAAAC,EAAAJ,EAAAK,QAAAC,MAAAH,GAAA,EAASI,EACTH,EAAAI,MACI5E,KAAKY,IAAIC,KAAKgE,QAAO,EAAAC,EAAAnE,SAASoE,EAAApE,QAAT,CAA0BgE,IAE/C3E,KAAKgF,YAELC,WAAW,WAEPC,EAAKtE,IAAIuE,OAAOC,YAAY,0BAA0B9C,SAAS,2BAEnE,2YAMJtC,KAAKqF,gBACAC,KAAK,WAEFC,QAAQC,YAEXC,MAAM,SAAAC,GAEHH,QAAQI,OAAO,IAAIC,MAAJ,+CAAyDF,yBAMzE9F,0WCxKfiG,EAAAlG,EAAA,QAMAmG,aAcI,SAAAA,EAA8BC,GAAmD,IAAjBjG,EAAiBkG,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,MAI7E,+FAJ6EjG,CAAAC,KAAA8F,GAAnD9F,KAAA+F,UAAkC/F,KAAAF,OAZtDE,KAAAY,OAEAZ,KAAAmG,WAYNnG,KAAKH,IAAK,EAAAgG,EAAAO,qBAAoBL,QAEP,IAAZ/F,KAAKH,KAAuBG,KAAKH,GAAGoG,OAE3C,MAAM,IAAII,eAAe,sEAG7BjG,OAAOkG,OAAOtG,KAAKmG,QAASrG,GAE5BE,KAAKuG,UACLvG,KAAKwG,OACLxG,KAAKgF,YACLhF,KAAKyG,qBACLzG,KAAK0G,0MAwCLtG,OAAOkG,OAAOtG,KAAKY,KAAK,EAAA+F,EAAAC,wBAAuB5G,KAAKH,wBAI7CiG,qBCpFfe,EAAAC,QAAA","file":"5.js","sourcesContent":["\n// @ts-ignore\nimport Module from 'core/module';\n\n// @ts-ignore\nimport debounce from 'lodash/debounce';\n\n// @ts-ignore\nimport template from 'lodash/template';\n\n// @ts-ignore\nimport galleryItemTmpl from './gallery-item';\n\nclass Gallery extends Module\n{\n    private filters: Array<string> = [];\n    private loadCnt: number = 0;\n\n    private readonly scrollThreshold: number = 900;\n\n    constructor(el: string | JQuery, opts: object)\n    {\n        super(el, opts);\n    }\n\n    render()\n    {\n\t\tthis.dom.imgs.magnificPopup(\n        {\n            delegate: '.tile:not(.ftg-hidden) .tile-inner',\n            type: 'image',\n            removalDelay: 300,\n            mainClass: 'mfp-fade mfp-with-zoom',\n            gallery:\n            {\n                enabled: true,\n                preload: [0,2],\n                navigateByImgClick: true,\n                arrowMarkup: '<button title=\"%title%\" type=\"button\" class=\"mfp-arrow mfp-arrow-%dir%\"></button>',\n                tPrev: 'Previous (Left arrow key)',\n                tNext: 'Next (Right arrow key)',\n                tCounter: '<span class=\"mfp-counter\">%curr% of %total%</span>'\n            },\n            zoom:\n            {\n                enabled: true,\n                duration: 300,\n                easing: 'ease-in-out',\n                opener: function(openerElement)\n                {\n                    return openerElement.is('img') ? openerElement : openerElement.find('img');\n                }\n            },\n            callbacks:\n            {\n                change: function()\n                {\n                    if (this.isOpen)\n                    {\n                        this.wrap.addClass('mfp-open');\n                    }\n                }\n            },\n\t        fixedContentPos: false\n        });\n\n        this.dom.imgs.finalTilesGallery(\n        {\n            margin: 15,\n            minTileWidth: 200,\n            gridSize: 50,\n            imageSizeFactor: [[4000, .4],[1280, .3],[1024, .7],[600, .6],[480, .5]],\n            columns:\n            [\n                [4000, 4],\n                [1280, 3],\n                [1024, 2],\n                [600, 1],\n                [320, 1]\n            ],\n        });\n    }\n\n    bindEventListeners()\n    {\n        //$(window).on('scroll', (e) => this.onWindowScroll(e));\n\n        //this.dom.filterLnk.on('click touchend', (e) => this.onFilterChange(e));\n        this.dom.loadmoreLnk.on('click touchend', (e) => this.onLoadMoreClick(e));\n    }\n\n    onWindowScroll(e: JQuery.Event<Window, null>) : void\n    {\n        const self = $(e.currentTarget);\n\n        this.dom.filter.toggleClass('scroll', self.scrollTop() > this.scrollThreshold);\n    }\n\n    onFilterChange(e)\n    {\n        const self = $(e.currentTarget);\n        const filter = self.data('filter');\n\n        if (this.filters.includes(filter))\n        {\n            this.filters.splice(this.filters.findIndex((item) =>\n            {\n                return item === filter;\n            }), 1);\n        }\n        else\n        {\n            this.filters.push(filter);\n        }\n\n        self.toggleClass('gallery__filter-lnk--selected');\n\n        //console.log(this.filters);\n\n        this.onGetGalleryImages();\n\n        e.preventDefault();\n    }\n\n    onLoadMoreClick(e: EventTarget) : void\n    {\n        this.onGetGalleryImages();\n\n        e.preventDefault();\n    }\n\n    getGalleryImages() : JQuery.jqXHR<any>\n    {\n        return $.getJSON('/data/gallery.json');\n    }\n\n    async renderGallery() : Promise<any>\n    {\n        const images = await this.getGalleryImages();\n\n        //console.log((images[0].height / images[0].width) * 300);\n\n        let items = [];\n\n        for (let image of images)\n        {\n            this.dom.imgs.append(template(galleryItemTmpl)(image));\n\n            this.updateDom();\n\n            setTimeout(() =>\n            {\n                this.dom.imgLnk.removeClass('gallery__img-lnk--init').addClass('gallery__img-lnk--init');\n            },\n            50);\n        }\n    }\n\n    onGetGalleryImages() : void\n    {\n        this.renderGallery()\n            .then(() =>\n            {\n                Promise.resolve();\n            })\n            .catch(err =>\n            {\n                Promise.reject(new Error(`There was an issue fetching your results => ${err}`));\n            });\n    }\n\n}\n\nexport default Gallery;\n","\n// @ts-ignore\nimport { getCachableDomElements } from 'core/bootstrap';\n\n// @ts-ignore\nimport { getInstanceOfjQuery } from 'helpers/utils';\n\n/**\n * Abstract Module class.\n * All modules inherit from this class.\n */\nabstract class Module\n{\n    protected dom: object = {};\n\n    protected options: object = {};\n\n    protected el: JQuery;\n\n   /**\n     * Module constructor\n     *\n     * @param {string|JQuery} el Main DOM element in any valid jQuery form i.e. `#foo` or `.bar` or `[data-baz]` or an actual jQuery object.\n     * @param {Object} [opts={}] Module options.\n    */\n    protected constructor(private element: string | JQuery, private opts: object = {})\n    {\n        this.el = getInstanceOfjQuery(element);\n\n        if (typeof this.el === 'undefined' || !this.el.length)\n        {\n            throw new ReferenceError('You must provide an valid element as a string type or jquery type.');\n        }\n\n        Object.assign(this.options, opts);\n\n        this.preInit();\n        this.init();\n        this.updateDom();\n        this.bindEventListeners();\n        this.render();\n\n        if (__DEV__)\n        {\n            const moduleName = this.el.data('module').split(/\\//g).pop();\n\n            if (!!Object.keys(this.dom).length)\n            {\n                console.log(`Cached DOM for module: ${moduleName} =>`, this.dom);\n            }\n\n            if (!!Object.keys(this.options).length)\n            {\n                console.log(`Options for module: ${moduleName} =>`, this.options);\n            }\n        }\n    }\n\n    /**\n     * @abstract\n     */\n    protected preInit() : void {};\n\n    /**\n     * @abstract\n     */\n    protected init() : void {};\n\n    /**\n     * @abstract\n     */\n    protected render() : void {};\n\n    /**\n     * @abstract\n     */\n    protected bindEventListeners() : void {};\n\n    protected updateDom() : void\n    {\n        Object.assign(this.dom, getCachableDomElements(this.el));\n    };\n}\n\nexport default Module;\n","module.exports = \" <div class=\\\"tile ftg-loaded\\\" data-img=\\\"<%= src %>\\\"> <a href=\\\"<%= src %>\\\" title=\\\"<%= title %>\\\" class=\\\"gallery__img-lnk tile-inner\\\"> <img src=\\\"<%= src %>\\\" data-src=\\\"<%= src %>\\\" alt=\\\"<%= title %>\\\" title=\\\"<%= title %>\\\" class=\\\"gallery__img item\\\"/> </a> </div> \";"],"sourceRoot":""}